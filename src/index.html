<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />

  <title>gallery+</title>

  <!-- Image link template to be reused. -->
  <script id="link" type="text/html">
    <a-entity
      class="link"
      geometry="primitive: plane; height: 3; width: 3"
      look-at="[camera]"
      material="shader: flat; src: ${thumb}"
      onmouseenter="mouseEnterLink(event)"
      onmouseleave="mouseLeaveLink(event)"
      onmousedown="mouseDownLink(event)"
    ></a-entity>
  </script>

  <script>
    function mouseDownLink(event) {
      if (event.detail.cursorEl.id === "click-cursor") {
        let imageId = event.target.parentElement.dataset['thumb']
        let url = document.getElementById(imageId.substring(1)).src
        document.getElementById("spotlight-image").style['background-image'] =
          "url(" + url + ")"
        document.getElementById("spotlight").style.display = "block"
      }
    }
    function mouseEnterLink(event) {
      let cursorId = event.detail.cursorEl.id;
      if (AFRAME.utils.device.isMobile() && cursorId !== "hover-cursor")
        return;
      if (!AFRAME.utils.device.isMobile() && cursorId !== "click-cursor")
        return;

      event.target.object3D.scale.set(1.2, 1.2, 1.2);
    }
    function mouseLeaveLink(event) {
      let cursorId = event.detail.cursorEl.id;
      if (AFRAME.utils.device.isMobile() && cursorId !== "hover-cursor")
        return;
      if (!AFRAME.utils.device.isMobile() && cursorId !== "click-cursor")
        return;

      event.target.object3D.scale.set(1.0, 1.0, 1.0);
    }

    function mouseUp(event) {
      document.getElementById("spotlight").style.display = 'none'
    }
  </script>

</head>
<body
  onmouseup="mouseUp(event)">

  <div
    id="spotlight"
    style="
      background: #000;
      width: 100%;
      height: 100%;
      z-index: 1100;
      position: fixed;
      display: none;
    "
  >
    <div
      id="spotlight-image"
      style="
        background-position: center;
        background-repeat: no-repeat;
        background-size: contain;
        width: 100%;
        height: 100%;
        z-index: 1000;
        position: fixed;
      "
    >
    </div>
  </div>

  <a-scene
    style="z-index: 0;"
    vr-mode-ui="enabled: false"
    loading-screen="dotsColor: white; backgroundColor: black"
  >

    <a-sky
      color="#000"
    >
    </a-sky>

    <a-assets>
      <img id="cubes-thumb" src="../assets/cubes.jpg">
    </a-assets>

    <!-- images -->
    <a-entity layout="type: circle; radius: 15; plane: xz" position="0 4 0">
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>

      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
    </a-entity>

    <a-entity layout="type: circle; radius: 15; plane: xz" position="0 0 0">
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>

      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>

      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
    </a-entity>

    <a-entity layout="type: circle; radius: 15; plane: xz" position="0 -4 0">
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>

      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>

      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
    </a-entity>

    <a-entity layout="type: circle; radius: 15; plane: xz" position="0 -8 0">
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>

      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
      <a-entity template="src: #link" data-thumb="#cubes-thumb"></a-entity>
    </a-entity>

    <!-- camera -->
    <a-entity position="0 0 0">
      <a-entity
        id="camera"
        camera
        look-controls="reverseMouseDrag: true"
      >
        <a-entity
          id="click-cursor"
          cursor="rayOrigin: mouse; fuse: false"
          raycaster="objects: .link"
        >
        </a-entity>
        <a-entity
          id="hover-cursor"
          only-mobile
          position="0 0 -3"
          geometry="primitive: ring; radiusInner: 0.03; radiusOuter: 0.05;"
          material="color: #b2ff59; shader: flat"
          cursor="fuse: false"
          raycaster="objects: .link"
        >
        </a-entity>
      </a-entity>
    </a-entity>

  </a-scene>

</body>
</html>
